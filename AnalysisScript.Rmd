---
title: "AnalysisScript - Breast Cancer Wisconsin (Diagnostic)"
author: "Thanh La, Son Luong"
date: "10/17/2021"
output:
  pdf_document: default
  html_document: default
director: Dr. Katherine Shoemaker
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(reshape2)
library(reshape)
library(ggplot2)
library(GGally)
library(ISLR)
library(caret)
library(cowplot)
library(MASS)
library(dplyr)

```


```{r}
workfile <- read.csv("data.csv")
numeric_workfile <- workfile[,3:32 ]
```

# workfile Exploration

```{r}
colnames(workfile)
```

```{r}
summary(numeric_workfile)
all(is.na(workfile))
```

# workfile Visualization

# I. Relationship Between Variable

```{r}
group = NA
group[workfile$diagnosis == "B"] = 1
group[workfile$diagnosis == "M"] = 2


workfile %>% 
  select_if(is.numeric) %>%
  dplyr::select(contains("mean")) %>%
  pairs(col = c("blue", "red")[group], main = "The relationship between 'Mean' variable")

workfile %>% 
  select_if(is.numeric) %>% 
  dplyr::select(contains("SE")) %>% 
  pairs(col = c("blue", "red")[group], main = "The relationship between 'Standard Error' variable")

workfile %>% 
  select_if(is.numeric) %>% 
  dplyr::select(contains("worst")) %>% 
  pairs(col = c("blue", "red")[group], main = "The relationship between 'Worst' variable") 
```

# II. Differently Distributed Between Two Group of Diagnosis

# look at how the variables are differently distributed between the two groups

# these variables below are greatly different among 2 group of diagnosis

```{r}
ggpairs(workfile[,c(3:12,2)], aes(color=diagnosis, alpha=0.5), lower=list(continuous="smooth"))
```
```{r}
ggpairs(workfile[,c(13:22,2)], aes(color=diagnosis, alpha=0.5), lower=list(continuous="smooth"))
```
```{r}
ggpairs(workfile[,c(23:32,2)], aes(color=diagnosis, alpha=0.5), lower=list(continuous="smooth"))
```

cor()#
cov()#
https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor

# III. Logistic Regression Model
```{r}
workfile$diagnosis = as.factor(workfile$diagnosis)
workfile = subset(workfile, select = -c(id))
```

```{r}
head(workfile)
```


# Apply logistic regression to data 

```{r, include = F, echo  =F}
# Set the train and test part of valiadation dataset
index_set = sample(2, nrow(workfile), replace = T, prob = c(0.9, 0.1))
train_workfile = workfile[index_set == 1,] 
test_workfile = workfile[index_set == 2,]
```

To make the logistic regression model more efficient (or improve the probability of the prediction), I will separate the characteristic variable to different part such as: size, shape, surface
+ Every variable
```{r}
by_all = function(workfile){
  workfile_glm = glm(diagnosis~ ., family = "binomial", data = workfile)
  return(workfile_glm)
}
```

+ Size: Radius, perimeter, area, compactness, fractal dimension

```{r}
by_size = function(workfile){
  workfile_glm = glm(diagnosis~ radius_mean + radius_se + radius_worst + perimeter_mean + perimeter_se + perimeter_worst + area_mean + area_se + area_worst + compactness_mean + compactness_se + compactness_worst + fractal_dimension_mean +  fractal_dimension_se + fractal_dimension_worst, family = "binomial", data = workfile)
  return(workfile_glm)
}
```

+shape, surface: texture, smoothness, concavity, concave.points, symmetry, fractal dimension
```{r}
by_shape = function(workfile){
  workfile_glm = glm(diagnosis~ texture_mean + texture_se + texture_worst + smoothness_mean + smoothness_se + smoothness_worst + concavity_mean + concavity_se + concavity_worst + concave.points_mean + concave.points_se + concave.points_worst + symmetry_mean + symmetry_se + symmetry_worst + fractal_dimension_mean +  fractal_dimension_se + fractal_dimension_worst, family = "binomial", data = workfile)
  return(workfile_glm)
}

```


#  Build a Train - Test of Logistic Regression 

Train - test by size

```{r}
workfile_glm = by_all(train_workfile)
summary(workfile_glm)
```

```{r}
# now ewe predict on the test data
y_hat = predict(workfile_glm, newdata = test_workfile, type = "response")
predicted_class <- vector(length = length(y_hat))
predicted_class[y_hat > 0.5] <- "M"
predicted_class[y_hat <= 0.5] <- "B"
predicted_class <- as.factor(predicted_class)

confusionMatrix(predicted_class, test_workfile$diagnosis)



```





















